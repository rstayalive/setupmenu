#############################################################################################
#Author: Sergey Tishin
#site: itotdel.pro
#email: rstayalive@gmail.com
~~~~~~~~~~~~~~~~~~~~~~
#Скрипт автоматизации развертывания FreePBX 11/13/14
#Пожелания и ошибки кидайте на почту rstayalive@gmail.com
#Этот скрипт поможет вам меньше нажимать кнопок.
#А так же сократит время настройки в разы.
#Писалось на коленке, так что как то так.
#Обновления выходят тогда, когда находятся ошибки или нужен новый функционал.
#Ну дальше везде каменты есть, разберетесь что к чему.
#############################################################################################
#Скрипт можете использовать и распространять как хотите
#Подпишитесь на бота в телеграме !!!!!!! @rstgithubbot
#Подписавшись на бота вы будете всегда в курсе последних обнов.
#############################################################################################
v4.7
Испралвены баги в продлении/обновлении/проверке сертификатов простых звонков
Исправлены мелкие косяки в большинстве модулей
Добвлены новые user agent ботов в правила защиты iptables
Добавлена проверка y/n на установку простых звонков
~~~~~~~~~~~~~~~~~~~~~~
v4.6  Изменения
Выпилил установку zabbix агента из-за ненадобности
Подправил скрипты автообновления сертификатов простых звонков(без особовых изменений)
Новый список правил iptables, старый содержал изъяны
~~~~~~~~~~~~~~~~~~~~~~
v4.5
Исправлено:
ошибка в отчете о пропущенных на каждый день
ошибка в списке правил защиты iptables
ошибка в инстаяции sngrep
ошибка в инсталяции xtables-addons
ошибка в проверке версии lunux
ошибка в модуле callback
множество ошибок в основном модуле
исправлены косяки отображения меню
Добавлено:
Новая инсталяция простых звонков, старую снес
Поддержка Centos 7
Пакет iptraf в скрипт инсталяции софта
Переписан полностью срипт проверки ssl сертификата
Написан скрипт автообновления ssl сертификата простых звонков
Полноценное обновление setupmenu и всех его скриптов с github
Установка zabbix агента и подключение к серверу zabbix в авто режиме
~~~~~~~~~~~~~~~~~~~~~~
v4.3
Добавил скрипт подмены ssl сертификатов простых звонков доменным
Добавил скрипт проверки ssl сертификата
Дописал коменты к коду в основном скрипте
Запилил telegram бота @rstgithubbot
~~~~~~~~~~~~~~~~~~~~~~
v4.2
Дописана куча проверок в скрипт xtables_geip
исправлена куча багов
~~~~~~~~~~~~~~~~~~~~~~
v4.1
Переписан скрипт xtables, исправлены постоянные косяки с репозиториями, выкачаны необходимые файлы
положены в src, теперь будет при установке оттуда брать.
Устранены косяки с меню простых звонков, возвращало обратно после выбора 13 астериска
Так же переписаны скрипты установки простых звонков, убрал генерацию сертификата простых звонков
вывел это в отдельный пункт меню.
~~~~~~~~~~~~~~~~~~~~~~
v4.0
переписан полностью скрипт на локальную работу, залит на гит, теперь можно работать независимо
~~~~~~~~~~~~~~~~~~~~~~
v3.5
Перестроены все меню, удалены не нужные меню и добавлены новые, удален не нужный/устаревший функционал
Написаны скрипты для правил iptables, чтобы уменьшить размер основного скрипта и для удобства отладки
Поправлен скрипт отключения модулей, добавлены новые модули которые нужно отключить
Добавлены скрипты настройки callback и click2call
Удален билдер правил для iptables
~~~~~~~~~~~~~~~~~~~~~~
v3.4.5
В iptables добалены пункты открыть порт и удалить модуль firewall из freepbx 
~~~~~~~~~~~~~~~~~~~~~~
v3.4.4
Написан скрипт настройки системы для отправки отчета о пропущенных звонках на email каждый день в 17:30
~~~~~~~~~~~~~~~~~~~~~~
v3.4.3
Написан скрипт настройки уведомлений на email с ivr меню.
~~~~~~~~~~~~~~~~~~~~~~
v3.4.2
Добавлена возможность добавления ip провайдеров телефонии в блоке Iptables
~~~~~~~~~~~~~~~~~~~~~~
v3.4.1
Добавлена установка sngrep 
~~~~~~~~~~~~~~~~~~~~~~
v3.4 
Изменен title + дописан author
Написан скрипт подмены cel.conf который слетает  при обновлении астериска
Дописан пункт в скрипте установить софт, типа mc,iftop,mtr и тд
Объединить 4 скрипта простых звонков в 1 скрипт с вопросами, для удобства и простоты
теперь есть публикация installcertificate на веб сервере, так же спрашивает ip астериска, перед публикацией
Устранен косяк с остающимся конфликтным репозиторием после установки geoip
При установке стандартных правил дописан вопрос есть внешний Ip или нет.
~~~~~~~~~~~~~~~~~~~~~~
v3.3 
Теперь во время добавления стандартных правил, скрипт спрашивает, нужно открывать порт простых звонков или нет
Исправлена проблема установки модуля xtables + geoip, когда не ставился perl-text
Исправлены мелкие недочеты и ошибки в тексте.
Добавлен выбор между правилами geoip хардкор или lite
(hardcore) Добавляет в бан все страны по всем портам и протоколам.
(Lite) Добавляет в бан все страны по порту 5060
~~~~~~~~~~~~~~~~~~~~~~
v3.2
Добавлено удаление остаточных файлов после выхода из скрипта.
Исправлены ошибки в некоторых скриптах.
Добавлена возможность при добавлении стандартных правил в iptables, вписывать localnet,externip,sipport.
Добавлена возможность использовать свой email для отправки писем с астериска в скрипт настройки postfix.
Теперь при добавлении правил в iptables скрипт будет спрашивать сохранить правила или нет.
~~~~~~~~~~~~~~~~~~~~~~
v3.1
Обновлен список правил iptables.
Переписан вывод главного меню.
Добавлена функция обновления сертификата простых звонков на более длительный срок.
Переписаны скрипты установки простых звонков с более длинными сертификатами.
Обновлена функция обновления скрипта.
~~~~~~~~~~~~~~~~~~~~~~
v3.0
Переписано главное меню и созданы подменю.
Скрипт разбит на мелкие скрипты, для простоты отладки.
Сделан releasenotes
~~~~~~~~~~~~~~~~~~~~~~